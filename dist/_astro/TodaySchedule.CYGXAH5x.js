import{w as g}from"./runtime-dom.esm-bundler.BO0y7nUc.js";/* empty css                        */import{_ as F}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{c as l,d as f,t as o,n as O,a,F as C,r as S,g as u,h as m,o as U,j as c}from"./runtime-core.esm-bundler.BjMZvgip.js";const R={__name:"TodaySchedule",setup(N,{expose:r}){r();const v=u(!1),e=u(null),k=u(null),w=u(""),i=u(!1),_=u([]);class y{constructor(t){this.id=t?.id,this.name=t?.name||"",this.teacher=t?.teacher||"",this.price=t?.price||"",this.bookingUrl=t?.bookingUrl||"",this.startTime=t?.date?.start?new Date(t.date.start):new Date,this.endTime=t?.date?.end?new Date(t.date.end):new Date,this.tags=t?.tags||null}get isIceBath(){return this.name?.toLowerCase().includes("dip")||!1}}const E=()=>{v.value=!v.value},B=async()=>{const t=await(await fetch("https://kty-cloudflare-workers.eve-460.workers.dev/kty-schedule-week")).json();e.value=t,_.value=t?.data?.map(n=>new y(n))||[],i.value=!0,console.log("Schedule Items:",_.value.map(n=>({id:n.id,name:n.name,teacher:n.teacher,price:n.price,bookingUrl:n.bookingUrl,startTime:n.startTime,endTime:n.endTime,isIceBath:n.isIceBath,tags:n.tags})))},D=()=>{const s=new Date;return s.setHours(0,0,0,0),s},I=s=>{const t=D(),n=new Date(s);return n.setHours(0,0,0,0),n.getTime()===t.getTime()},h=m(()=>_.value.length?_.value.filter(s=>I(s.startTime)).sort((s,t)=>{const n=s.startTime-t.startTime;return n!==0?n:(s.isIceBath?1:0)-(t.isIceBath?1:0)}):[]),p=m(()=>{if(!h.value.length)return null;const s=new Date;return h.value.filter(t=>t.startTime>s).sort((t,n)=>{const d=t.startTime-n.startTime;return d!==0?d:(t.isIceBath?1:0)-(n.isIceBath?1:0)})[0]||null}),T=m(()=>{if(!h.value.length)return[];const s=new Date;return h.value.filter(t=>s>=t.startTime&&s<=t.endTime)}),L=m(()=>{if(!h.value.length)return[];const s=new Date;return h.value.filter(t=>t.startTime>s).sort((t,n)=>{const d=t.startTime-n.startTime;return d!==0?d:(t.isIceBath?1:0)-(n.isIceBath?1:0)})}),H=m(()=>T.value?.length?T.value.some(s=>s.isIceBath):!1),M=m(()=>T.value?.length?T.value.find(s=>s.isIceBath):null),x=()=>{if(!p.value)return;const s=new Date;w.value=s.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"});const t=p.value.startTime-s,n=Math.floor(t/6e4),d=Math.floor(n/60);k.value=d>0?`${d}h ${n%60}m`:`${n}m`},j=s=>s.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"});U(async()=>{await B(),x(),setInterval(x,6e4)});const b={expanded:v,scheduleResponse:e,timeUntilNext:k,currentTime:w,isLoaded:i,scheduleItems:_,ScheduleItem:y,handleToggleExpand:E,loadSchedule:B,getTodayDate:D,isToday:I,todaysClasses:h,nextClass:p,currentClasses:T,futureClasses:L,nowDipInIceBath:H,currentIceBath:M,updateTimer:x,formatTime:j,ref:u,onMounted:U,computed:m};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}},P={key:0,class:"schedule-preview"},V={key:1,class:"schedule-list"},z={class:"schedule-header"},A={class:"header-time"},q={key:0,class:"next-class"},G={class:"white"},J={class:"schedule-item highlight"},K={class:"title"},Q={class:"teacher"},W={class:"time"},X={class:"price"},Y=["href"],Z={key:1,class:"current-class"},$={class:"title"},ee={class:"time"},te={class:"upcoming-classes"},se={class:"title"},ne={class:"time"},ae=["href"],oe={class:"full-schedule-container"};function ie(N,r,v,e,k,w){return c(),l(C,null,[e.nowDipInIceBath&&!e.expanded?(c(),l("div",{key:0,class:"ice-bath-live",onClick:e.handleToggleExpand}," ðŸ§Š ICE BATH OPEN UNTIL "+o(e.formatTime(e.currentIceBath?.endTime))+" come now 200THB ",1)):f("",!0),e.scheduleResponse?(c(),l("div",{key:1,class:O(["schedule-widget",{expanded:e.expanded,"fade-in-up":e.isLoaded}]),onClick:e.handleToggleExpand},[!e.expanded&&e.nextClass?(c(),l("div",P,[a("span",null,"Next: "+o(e.nextClass.name),1),a("span",null,"in "+o(e.timeUntilNext),1)])):f("",!0),e.expanded?(c(),l("div",V,[a("div",z,[a("span",A,o(e.currentTime),1),a("button",{class:"close-btn",onClick:g(e.handleToggleExpand,["stop"])},"âœ•")]),e.nextClass?(c(),l("div",q,[a("h3",G,"Next Class in "+o(e.timeUntilNext),1),a("div",J,[a("div",null,[a("div",K,o(e.nextClass.name),1),a("div",Q,"with "+o(e.nextClass.teacher),1),a("div",W,o(e.formatTime(e.nextClass.startTime))+" - "+o(e.formatTime(e.nextClass.endTime)),1),a("div",X,o(e.nextClass.price),1)]),a("a",{href:e.nextClass.bookingUrl,class:"book-btn",target:"_blank",onClick:r[0]||(r[0]=g(()=>{},["stop"]))}," Book Now ",8,Y)])])):f("",!0),e.currentClasses.length?(c(),l("div",Z,[r[3]||(r[3]=a("h3",{class:"white"},"Currently Running:",-1)),(c(!0),l(C,null,S(e.currentClasses,i=>(c(),l("div",{key:i.id,class:"schedule-item in-progress"},[a("div",$,o(i.name),1),a("div",ee,o(e.formatTime(i.startTime))+" - "+o(e.formatTime(i.endTime)),1)]))),128))])):f("",!0),a("div",te,[r[4]||(r[4]=a("h3",{class:"white"},"Upcoming Classes:",-1)),(c(!0),l(C,null,S(e.futureClasses,i=>(c(),l("div",{key:i.id,class:"schedule-item"},[a("div",null,[a("span",se,o(i.name),1),a("span",ne,o(e.formatTime(i.startTime))+" - "+o(e.formatTime(i.endTime))+" - "+o(i.price),1)]),a("a",{href:i.bookingUrl,class:"book-btn",target:"_blank",onClick:r[1]||(r[1]=g(()=>{},["stop"]))}," Book ",8,ae)]))),128))]),a("div",oe,[a("a",{href:"/class-schedule",class:"full-schedule-btn",onClick:r[2]||(r[2]=g(()=>{},["stop"]))}," Check Full Schedule ")])])):f("",!0)],2)):f("",!0)],64)}const he=F(R,[["render",ie],["__scopeId","data-v-ac7d2f0f"]]);export{he as default};
