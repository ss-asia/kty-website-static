import{w as _}from"./runtime-dom.esm-bundler.DkyClkfo.js";import V from"./IceBathScheduler.tqy2pQT-.js";/* empty css                        */import{_ as j}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{c as l,e as m,t as o,n as P,a,F as y,f as b,k as z,r as f,i as h,o as U,b as c}from"./runtime-core.esm-bundler.CA8gpptq.js";/* empty css                       */const A={__name:"TodaySchedule",setup(N,{expose:r}){r();const T=f(!1),t=f(null),g=f(null),w=f(""),i=f(!1),v=f([]);class C{constructor(e){this.id=e?.id,this.name=e?.name||"",this.teacher=e?.teacher||"",this.price=e?.price||"",this.bookingUrl=e?.bookingUrl||"",this.startTime=e?.date?.start?new Date(e.date.start):new Date,this.endTime=e?.date?.end?new Date(e.date.end):new Date,this.tags=e?.tags||null}get isIceBath(){return this.name?.toLowerCase().includes("dip")||!1}}const E=()=>{T.value=!T.value},x=async()=>{const e=await(await fetch("https://kty-cloudflare-workers.eve-460.workers.dev/kty-schedule-week")).json();t.value=e,v.value=e?.data?.map(n=>new C(n))||[],i.value=!0,console.log("Schedule Items:",v.value.map(n=>({id:n.id,name:n.name,teacher:n.teacher,price:n.price,bookingUrl:n.bookingUrl,startTime:n.startTime,endTime:n.endTime,isIceBath:n.isIceBath,tags:n.tags})))},B=()=>{const s=new Date;return s.setHours(0,0,0,0),s},D=s=>{const e=B(),n=new Date(s);return n.setHours(0,0,0,0),n.getTime()===e.getTime()},d=h(()=>v.value.length?v.value.filter(s=>D(s.startTime)).sort((s,e)=>{const n=s.startTime-e.startTime;return n!==0?n:(s.isIceBath?1:0)-(e.isIceBath?1:0)}):[]),k=h(()=>{if(!d.value.length)return null;const s=new Date;return d.value.filter(e=>e.startTime>s).sort((e,n)=>{const u=e.startTime-n.startTime;return u!==0?u:(e.isIceBath?1:0)-(n.isIceBath?1:0)})[0]||null}),L=h(()=>{if(!d.value.length)return[];const s=new Date;return d.value.filter(e=>s>=e.startTime&&s<=e.endTime&&!e.isIceBath)}),H=h(()=>{if(!d.value.length)return[];const s=new Date;return d.value.filter(e=>e.startTime>s&&!e.isIceBath).sort((e,n)=>{const u=e.startTime-n.startTime;return u!==0?u:(e.isIceBath?1:0)-(n.isIceBath?1:0)})}),M=h(()=>{if(!d.value.length)return!1;const s=new Date;return d.value.some(e=>e.isIceBath&&s>=e.startTime&&s<=e.endTime)}),O=h(()=>{if(!d.value.length)return null;const s=new Date;return d.value.find(e=>e.isIceBath&&s>=e.startTime&&s<=e.endTime)}),S=h(()=>{const s=new Date;return new Date(s.getTime()+7*60*60*1e3).toISOString().split("T")[0]}),F=h(()=>{if(!t.value?.data)return[];const s=S.value;return t.value.data.filter(e=>e.name?.toLowerCase().includes("dip")?e.date?.start?.split("T")[0]===s:!1)}),p=()=>{if(!k.value)return;const s=new Date;w.value=s.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"});const e=k.value.startTime-s,n=Math.floor(e/6e4),u=Math.floor(n/60);g.value=u>0?`${u}h ${n%60}m`:`${n}m`},R=s=>s.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"});U(async()=>{await x(),p(),setInterval(p,6e4)});const I={expanded:T,scheduleResponse:t,timeUntilNext:g,currentTime:w,isLoaded:i,scheduleItems:v,ScheduleItem:C,handleToggleExpand:E,loadSchedule:x,getTodayDate:B,isToday:D,todaysClasses:d,nextClass:k,currentClasses:L,futureClasses:H,nowDipInIceBath:M,currentIceBath:O,todaysDateString:S,todaysIceBathEvents:F,updateTimer:p,formatTime:R,ref:f,onMounted:U,computed:h,IceBathScheduler:V};return Object.defineProperty(I,"__isScriptSetup",{enumerable:!1,value:!0}),I}},q={key:0,class:"schedule-preview"},G={key:1,class:"schedule-list"},J={class:"schedule-header"},K={class:"header-time"},Q={key:0,class:"next-class"},W={class:"white"},X={class:"schedule-item highlight"},Y={class:"title"},Z={class:"teacher"},$={class:"time"},ee={class:"price"},te=["href"],se={key:1,class:"current-class"},ne={class:"title"},ae={class:"time"},oe={key:2,class:"ice-bath-section"},re={class:"upcoming-classes"},ie={class:"title"},le={class:"time"},ce=["href"],de={class:"full-schedule-container"};function he(N,r,T,t,g,w){return c(),l(y,null,[t.nowDipInIceBath&&!t.expanded?(c(),l("div",{key:0,class:"ice-bath-live",onClick:t.handleToggleExpand}," ðŸ§Š ICE BATH OPEN UNTIL "+o(t.formatTime(t.currentIceBath?.endTime))+" come now 300THB ",1)):m("",!0),t.scheduleResponse?(c(),l("div",{key:1,class:P(["schedule-widget",{expanded:t.expanded,"fade-in-up":t.isLoaded}]),onClick:t.handleToggleExpand},[!t.expanded&&t.nextClass?(c(),l("div",q,[a("span",null,"Next: "+o(t.nextClass.name),1),a("span",null,"in "+o(t.timeUntilNext),1)])):m("",!0),t.expanded?(c(),l("div",G,[a("div",J,[a("span",K,o(t.currentTime),1),a("button",{class:"close-btn",onClick:_(t.handleToggleExpand,["stop"])},"âœ•")]),t.nextClass?(c(),l("div",Q,[a("h3",W,"Next Class in "+o(t.timeUntilNext),1),a("div",X,[a("div",null,[a("div",Y,o(t.nextClass.name),1),a("div",Z,"with "+o(t.nextClass.teacher),1),a("div",$,o(t.formatTime(t.nextClass.startTime))+" - "+o(t.formatTime(t.nextClass.endTime)),1),a("div",ee,o(t.nextClass.price),1)]),a("a",{href:t.nextClass.bookingUrl,class:"book-btn",target:"_blank",onClick:r[0]||(r[0]=_(()=>{},["stop"]))}," Book Now ",8,te)])])):m("",!0),t.currentClasses.length?(c(),l("div",se,[r[3]||(r[3]=a("h3",{class:"white"},"Currently Running:",-1)),(c(!0),l(y,null,b(t.currentClasses,i=>(c(),l("div",{key:i.id,class:"schedule-item in-progress"},[a("div",ne,o(i.name),1),a("div",ae,o(t.formatTime(i.startTime))+" - "+o(t.formatTime(i.endTime)),1)]))),128))])):m("",!0),t.todaysIceBathEvents.length?(c(),l("div",oe,[r[4]||(r[4]=a("h3",{class:"white"},"Ice Bath:",-1)),z(t.IceBathScheduler,{events:t.todaysIceBathEvents,"day-date":t.todaysDateString,"is-collapsed":!0},null,8,["events","day-date"])])):m("",!0),a("div",re,[r[5]||(r[5]=a("h3",{class:"white"},"Upcoming Classes:",-1)),(c(!0),l(y,null,b(t.futureClasses,i=>(c(),l("div",{key:i.id,class:"schedule-item"},[a("div",null,[a("span",ie,o(i.name),1),a("span",le,o(t.formatTime(i.startTime))+" - "+o(t.formatTime(i.endTime))+" - "+o(i.price),1)]),a("a",{href:i.bookingUrl,class:"book-btn",target:"_blank",onClick:r[1]||(r[1]=_(()=>{},["stop"]))}," Book ",8,ce)]))),128))]),a("div",de,[a("a",{href:"/class-schedule",class:"full-schedule-btn",onClick:r[2]||(r[2]=_(()=>{},["stop"]))}," Check Full Schedule ")])])):m("",!0)],2)):m("",!0)],64)}const ge=j(A,[["render",he],["__scopeId","data-v-45aae50e"]]);export{ge as default};
