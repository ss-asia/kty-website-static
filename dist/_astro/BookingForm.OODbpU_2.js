import{w as F,v as h}from"./runtime-dom.esm-bundler.DOLOcq9E.js";/* empty css                      */import{_ as I}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{c as s,a as t,d as O,e as d,F as U,f as V,t as n,w as C,g as D,n as S,h as v,r as y,i as M,o as E,j as N,b as l}from"./runtime-core.esm-bundler.Dw_mvVhn.js";const R=!1,q={__name:"BookingForm",setup(T,{expose:o}){o();const _="https://flow.thailandboattickets.com/webhook/kty-reserve-mat",e=v({peopleCount:2,name:"",email:"",couponCode:"",isMember:!1}),a=v({i:"",date:"",title:"",teacher:"",time:"",display_date:"",price:"",taxi:""}),c=v({peopleCount:"",name:"",email:"",isMember:""}),r=y(!1),f=y(!1),g=y(""),B=M(()=>a.title||a.teacher||a.display_date||e.name||e.email||e.peopleCount),x=M(()=>!a.price||!e.peopleCount?null:(parseFloat(a.price.replace(/[^0-9.-]+/g,""))||0)*e.peopleCount);E(()=>{const i=new URLSearchParams(window.location.search);a.i=i.get("i")||"",a.date=i.get("date")||"",a.title=i.get("title")||"",a.teacher=i.get("teacher")||"",a.time=i.get("time")||"",a.display_date=i.get("display_date")||"",a.price=i.get("price")||"",a.taxi=i.get("taxi")||"";try{const p=localStorage.getItem("booking");if(p){const b=JSON.parse(p);b.person_name&&(e.name=b.person_name),b.person_amount&&(e.peopleCount=b.person_amount),b.contact&&(e.email=b.contact),b.is_member!==void 0&&(e.isMember=b.is_member)}}catch(p){console.error("Error loading booking from cache:",p)}}),N(()=>[e.name,e.email,e.peopleCount],()=>{try{const i={person_name:e.name,person_amount:e.peopleCount,contact:e.email};localStorage.setItem("booking",JSON.stringify(i))}catch(i){console.error("Error saving booking to cache:",i)}});const P=()=>{let i=!0;return c.peopleCount="",c.name="",c.email="",c.isMember="",(!e.peopleCount||e.peopleCount<1)&&(c.peopleCount="Please select number of people",i=!1),e.name.trim()||(c.name="Name is required",i=!1),e.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email)||(c.email="Please enter a valid email",i=!1):(c.email="Email is required",i=!1),(e.isMember===null||e.isMember===void 0)&&(c.isMember="Please select your member status",i=!1),i},w={TEST_MODE:R,BOOKING_API_ENDPOINT:_,formData:e,bookingData:a,errors:c,isSubmitting:r,submitSuccess:f,submitError:g,hasBookingData:B,calculatedTotalPrice:x,validateForm:P,resetForm:()=>{e.couponCode="",e.peopleCount=2,e.isMember=!1,f.value=!1,g.value=""},handleSubmit:async()=>{if(P()){r.value=!0,f.value=!1,g.value="";try{let i="";if(a.price&&e.peopleCount){const u=parseFloat(a.price.replace(/[^0-9.-]+/g,""))||0,k=e.peopleCount;i=(u*k).toString()}const p={...e,...a,price:i||a.price,submittedAt:new Date().toISOString()};if(!(await fetch(_,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)})).ok)throw new Error("Failed to submit booking");try{const u=localStorage.getItem("booking"),k=u?JSON.parse(u):{};k.is_member=e.isMember,localStorage.setItem("booking",JSON.stringify(k))}catch(u){console.error("Error saving booking to cache:",u)}const m=new URLSearchParams;m.append("name",e.name),m.append("email",e.email),m.append("peopleCount",e.peopleCount),m.append("isMember",e.isMember),a.i&&m.append("i",a.i),a.title&&m.append("title",a.title),a.teacher&&m.append("teacher",a.teacher),a.time&&m.append("time",a.time),a.display_date&&m.append("display_date",a.display_date),a.price&&m.append("price",a.price),a.date&&m.append("date",a.date),e.couponCode&&m.append("couponCode",e.couponCode),window.location.href=`/after-booking?${m.toString()}`}catch(i){console.error("Error submitting booking:",i),g.value="Failed to submit booking. Please try again.",r.value=!1}}},ref:y,reactive:v,onMounted:E,computed:M,watch:N};return Object.defineProperty(w,"__isScriptSetup",{enumerable:!1,value:!0}),w}},J={class:"booking-container"},A={class:"booking-form-card"},L={key:0,class:"success-state"},Y={class:"form-field"},j={class:"people-selector"},H=["onClick"],W={key:0,class:"form-error"},z={class:"form-field"},G={key:0,class:"form-error"},K={class:"form-field"},Q={key:0,class:"form-error"},X={class:"form-field"},Z={class:"form-field"},$={class:"yes-no-buttons"},ee={key:0,class:"form-error"},oe=["disabled"],te={key:0,class:"button-loader"},ae={key:1},ie={key:0,class:"button-hint"},se={key:1,class:"error-message"},le={class:"booking-info-card"},ne={key:0,class:"booking-details"},re={key:0,class:"booking-detail-item"},de={class:"booking-detail-value"},me={key:1,class:"booking-detail-item"},ce={class:"booking-detail-value"},be={key:2,class:"booking-detail-item"},pe={class:"booking-detail-value"},ue={key:3,class:"booking-detail-item"},fe={class:"booking-detail-value"},ge={key:4,class:"booking-detail-item"},ke={class:"booking-detail-value"},ve={key:5,class:"booking-detail-item"},ye={class:"booking-detail-value",style:{"font-weight":"700","font-size":"1.1em"}},_e={key:6,class:"booking-detail-item"},he={class:"booking-detail-value"},Ce={key:7,class:"booking-detail-item"},De={class:"booking-detail-value"},Se={key:8,class:"booking-detail-item"},Me={class:"booking-detail-value"},Pe={key:9,class:"booking-detail-item"},we={class:"booking-detail-value"},Ee={class:"booking-detail-item"},Ne={class:"booking-detail-value"},Te={key:1,class:"booking-details-empty"};function Be(T,o,_,e,a,c){return l(),s("div",J,[t("div",A,[e.submitSuccess?(l(),s("div",L,[o[5]||(o[5]=O('<div class="success-icon" data-v-6b2bf27b><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-6b2bf27b><circle cx="12" cy="12" r="10" data-v-6b2bf27b></circle><path d="M9 12l2 2 4-4" data-v-6b2bf27b></path></svg></div><h2 class="success-title" data-v-6b2bf27b>Thank You!</h2><p class="success-message" data-v-6b2bf27b> Your mat has been reserved successfully! We&#39;ll contact you soon with confirmation details. </p>',3)),t("button",{onClick:e.resetForm,class:"reset-button"}," Make Another Booking ")])):(l(),s("form",{key:1,onSubmit:F(e.handleSubmit,["prevent"]),class:"booking-form"},[t("div",Y,[o[6]||(o[6]=t("label",{class:"form-label",for:"people-count"}," How many people ",-1)),t("div",j,[(l(),s(U,null,V(8,r=>t("button",{key:r,type:"button",class:S(["people-button",{"people-button--active":e.formData.peopleCount===r}]),onClick:f=>e.formData.peopleCount=r},n(r),11,H)),64))]),e.errors.peopleCount?(l(),s("div",W,n(e.errors.peopleCount),1)):d("",!0)]),t("div",z,[o[7]||(o[7]=t("label",{class:"form-label",for:"name"},[D(" Your name "),t("span",{class:"form-required"},"*")],-1)),C(t("input",{id:"name","onUpdate:modelValue":o[0]||(o[0]=r=>e.formData.name=r),type:"text",class:"form-input",placeholder:"Enter your name",autocomplete:"name"},null,512),[[h,e.formData.name]]),e.errors.name?(l(),s("div",G,n(e.errors.name),1)):d("",!0)]),t("div",K,[o[8]||(o[8]=t("label",{class:"form-label",for:"email"},[D(" Email "),t("span",{class:"form-required"},"*")],-1)),o[9]||(o[9]=t("p",{class:"form-description"},"We use your email only to inform you about your booking",-1)),C(t("input",{id:"email","onUpdate:modelValue":o[1]||(o[1]=r=>e.formData.email=r),type:"email",class:"form-input",placeholder:"your.email@example.com",autocomplete:"email"},null,512),[[h,e.formData.email]]),e.errors.email?(l(),s("div",Q,n(e.errors.email),1)):d("",!0)]),t("div",X,[o[10]||(o[10]=t("label",{class:"form-label",for:"coupon"}," Coupon Code (optional) ",-1)),o[11]||(o[11]=t("p",{class:"form-description"}," If you have a coupon code you can enter it here. When you pay at the studio you will get your discount. ",-1)),C(t("input",{id:"coupon","onUpdate:modelValue":o[2]||(o[2]=r=>e.formData.couponCode=r),type:"text",class:"form-input",placeholder:"Enter coupon code",autocomplete:"off"},null,512),[[h,e.formData.couponCode]])]),t("div",Z,[o[12]||(o[12]=t("label",{class:"form-label"},[D(" Are you already a member? "),t("span",{class:"form-required"},"*")],-1)),t("div",$,[t("button",{type:"button",class:S(["yn-button",{"yn-button--active":e.formData.isMember===!0}]),onClick:o[3]||(o[3]=r=>e.formData.isMember=!0)}," Yes ",2),t("button",{type:"button",class:S(["yn-button",{"yn-button--active":e.formData.isMember===!1}]),onClick:o[4]||(o[4]=r=>e.formData.isMember=!1)}," No ",2)]),e.errors.isMember?(l(),s("div",ee,n(e.errors.isMember),1)):d("",!0)]),t("button",{type:"submit",class:"submit-button",disabled:e.isSubmitting||!e.formData.name.trim()||!e.formData.email.trim()},[e.isSubmitting?(l(),s("span",te)):(l(),s("span",ae,"Reserve mat"))],8,oe),!e.formData.name.trim()||!e.formData.email.trim()?(l(),s("div",ie," Fill your email plus name to reserve your mat ")):d("",!0),e.submitError?(l(),s("div",se,n(e.submitError),1)):d("",!0)],32))]),t("div",le,[o[26]||(o[26]=t("h2",{class:"booking-info-title"},"Booking Summary",-1)),e.hasBookingData?(l(),s("div",ne,[e.bookingData.title?(l(),s("div",re,[o[13]||(o[13]=t("div",{class:"booking-detail-label"},"Class",-1)),t("div",de,n(decodeURIComponent(e.bookingData.title)),1)])):d("",!0),e.bookingData.teacher?(l(),s("div",me,[o[14]||(o[14]=t("div",{class:"booking-detail-label"},"Teacher",-1)),t("div",ce,n(e.bookingData.teacher),1)])):d("",!0),e.bookingData.display_date?(l(),s("div",be,[o[15]||(o[15]=t("div",{class:"booking-detail-label"},"Date",-1)),t("div",pe,n(decodeURIComponent(e.bookingData.display_date)),1)])):d("",!0),e.bookingData.time?(l(),s("div",ue,[o[16]||(o[16]=t("div",{class:"booking-detail-label"},"Time",-1)),t("div",fe,n(decodeURIComponent(e.bookingData.time)),1)])):d("",!0),e.bookingData.price?(l(),s("div",ge,[o[17]||(o[17]=t("div",{class:"booking-detail-label"},"Price per person",-1)),t("div",ke,n(e.bookingData.price)+" THB",1)])):d("",!0),e.calculatedTotalPrice!==null?(l(),s("div",ve,[o[18]||(o[18]=t("div",{class:"booking-detail-label"},"Total Price",-1)),t("div",ye,n(e.calculatedTotalPrice.toLocaleString())+" THB",1)])):d("",!0),o[24]||(o[24]=t("div",{class:"booking-detail-divider"},null,-1)),e.formData.peopleCount?(l(),s("div",_e,[o[19]||(o[19]=t("div",{class:"booking-detail-label"},"Number of People",-1)),t("div",he,n(e.formData.peopleCount),1)])):d("",!0),e.formData.name?(l(),s("div",Ce,[o[20]||(o[20]=t("div",{class:"booking-detail-label"},"Name",-1)),t("div",De,n(e.formData.name),1)])):d("",!0),e.formData.email?(l(),s("div",Se,[o[21]||(o[21]=t("div",{class:"booking-detail-label"},"Email",-1)),t("div",Me,n(e.formData.email),1)])):d("",!0),e.formData.couponCode?(l(),s("div",Pe,[o[22]||(o[22]=t("div",{class:"booking-detail-label"},"Coupon Code",-1)),t("div",we,n(e.formData.couponCode),1)])):d("",!0),t("div",Ee,[o[23]||(o[23]=t("div",{class:"booking-detail-label"},"Member Status",-1)),t("div",Ne,n(e.formData.isMember?"Member":"Not a member"),1)])])):(l(),s("div",Te,o[25]||(o[25]=[t("p",null,"Fill in the form to see your booking details",-1)])))])])}const Re=I(q,[["render",Be],["__scopeId","data-v-6b2bf27b"]]);export{Re as default};
