import{w as v}from"./runtime-dom.esm-bundler.DIpb8CDv.js";/* empty css                        */import{_ as M}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{c as l,e as m,t as o,n as z,a as s,F as k,r as b,g as u,h as _,i as I,o as c}from"./runtime-core.esm-bundler.BzG0XW5u.js";const F={__name:"TodaySchedule",setup(D,{expose:r}){r();const p=u(!1),e=u(null),T=u(null),g=u(""),i=u(!1),d=u([]);class C{constructor(t){this.id=t?.id,this.name=t?.property_name||"",this.teacher=t?.property_teacher?.[0]||"",this.price=t?.property_price?.[0]||"",this.bookingUrl=t?.property_booking_url||"",this.startTime=t?.property_date?.start?new Date(t.property_date.start):new Date,this.endTime=t?.property_date?.end?new Date(t.property_date.end):new Date}get isIceBath(){return this.name?.toLowerCase().includes("dip")||!1}}const S=()=>{p.value=!p.value},y=async()=>{const t=await(await fetch("https://e4thmoqoz1.execute-api.us-east-1.amazonaws.com/dev/schedule")).json();e.value=t,d.value=t?.items?.map(n=>new C(n))||[],i.value=!0,console.log("Schedule Items:",d.value.map(n=>({id:n.id,name:n.name,teacher:n.teacher,price:n.price,bookingUrl:n.bookingUrl,startTime:n.startTime,endTime:n.endTime,isIceBath:n.isIceBath})))},x=_(()=>{if(!d.value.length)return null;const a=new Date;return d.value.filter(t=>t.startTime>a).sort((t,n)=>{const h=t.startTime-n.startTime;return h!==0?h:(t.isIceBath?1:0)-(n.isIceBath?1:0)})[0]||null}),f=_(()=>{if(!d.value.length)return[];const a=new Date;return d.value.filter(t=>a>=t.startTime&&a<=t.endTime)}),U=_(()=>{if(!d.value.length)return[];const a=new Date;return d.value.filter(t=>t.startTime>a).sort((t,n)=>{const h=t.startTime-n.startTime;return h!==0?h:(t.isIceBath?1:0)-(n.isIceBath?1:0)})}),N=_(()=>f.value?.length?f.value.some(a=>a.isIceBath):!1),E=_(()=>f.value?.length?f.value.find(a=>a.isIceBath):null),w=()=>{if(!x.value)return;const a=new Date;g.value=a.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"});const t=x.value.startTime-a,n=Math.floor(t/6e4),h=Math.floor(n/60);T.value=h>0?`${h}h ${n%60}m`:`${n}m`},L=a=>a.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"});I(async()=>{await y(),w(),setInterval(w,6e4)});const B={expanded:p,scheduleResponse:e,timeUntilNext:T,currentTime:g,isLoaded:i,scheduleItems:d,ScheduleItem:C,handleToggleExpand:S,loadSchedule:y,nextClass:x,currentClasses:f,futureClasses:U,nowDipInIceBath:N,currentIceBath:E,updateTimer:w,formatTime:L,ref:u,onMounted:I,computed:_};return Object.defineProperty(B,"__isScriptSetup",{enumerable:!1,value:!0}),B}},R={key:0,class:"schedule-preview"},j={key:1,class:"schedule-list"},H={class:"schedule-header"},O={class:"header-time"},P={key:0,class:"next-class"},V={class:"white"},q={class:"schedule-item highlight"},A={class:"title"},G={class:"teacher"},J={class:"time"},K={class:"price"},Q=["href"],W={key:1,class:"current-class"},X={class:"title"},Y={class:"time"},Z={class:"upcoming-classes"},$={class:"title"},ee={class:"time"},te=["href"],se={class:"full-schedule-container"};function ne(D,r,p,e,T,g){return c(),l(k,null,[e.nowDipInIceBath&&!e.expanded?(c(),l("div",{key:0,class:"ice-bath-live",onClick:e.handleToggleExpand}," ðŸ§Š ICE BATH OPEN UNTIL "+o(e.formatTime(e.currentIceBath?.endTime))+" come now 200THB ",1)):m("",!0),e.scheduleResponse?(c(),l("div",{key:1,class:z(["schedule-widget",{expanded:e.expanded,"fade-in-up":e.isLoaded}]),onClick:e.handleToggleExpand},[!e.expanded&&e.nextClass?(c(),l("div",R,[s("span",null,"Next: "+o(e.nextClass.name),1),s("span",null,"in "+o(e.timeUntilNext),1)])):m("",!0),e.expanded?(c(),l("div",j,[s("div",H,[s("span",O,o(e.currentTime),1),s("button",{class:"close-btn",onClick:v(e.handleToggleExpand,["stop"])},"âœ•")]),e.nextClass?(c(),l("div",P,[s("h3",V,"Next Class in "+o(e.timeUntilNext),1),s("div",q,[s("div",null,[s("div",A,o(e.nextClass.name),1),s("div",G,"with "+o(e.nextClass.teacher),1),s("div",J,o(e.formatTime(e.nextClass.startTime))+" - "+o(e.formatTime(e.nextClass.endTime)),1),s("div",K,o(e.nextClass.price),1)]),s("a",{href:e.nextClass.bookingUrl,class:"book-btn",target:"_blank",onClick:r[0]||(r[0]=v(()=>{},["stop"]))}," Book Now ",8,Q)])])):m("",!0),e.currentClasses.length?(c(),l("div",W,[r[3]||(r[3]=s("h3",{class:"white"},"Currently Running:",-1)),(c(!0),l(k,null,b(e.currentClasses,i=>(c(),l("div",{key:i.id,class:"schedule-item in-progress"},[s("div",X,o(i.name),1),s("div",Y,o(e.formatTime(i.startTime))+" - "+o(e.formatTime(i.endTime)),1)]))),128))])):m("",!0),s("div",Z,[r[4]||(r[4]=s("h3",{class:"white"},"Upcoming Classes:",-1)),(c(!0),l(k,null,b(e.futureClasses,i=>(c(),l("div",{key:i.id,class:"schedule-item"},[s("div",null,[s("span",$,o(i.name),1),s("span",ee,o(e.formatTime(i.startTime))+" - "+o(e.formatTime(i.endTime))+" - "+o(i.price),1)]),s("a",{href:i.bookingUrl,class:"book-btn",target:"_blank",onClick:r[1]||(r[1]=v(()=>{},["stop"]))}," Book ",8,te)]))),128))]),s("div",se,[s("a",{href:"/class-schedule",class:"full-schedule-btn",onClick:r[2]||(r[2]=v(()=>{},["stop"]))}," Check Full Schedule ")])])):m("",!0)],2)):m("",!0)],64)}const le=M(F,[["render",ne],["__scopeId","data-v-3836aa0e"]]);export{le as default};
