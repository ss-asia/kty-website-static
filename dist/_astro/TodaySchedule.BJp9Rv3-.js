import{w as g}from"./runtime-dom.esm-bundler.Cny6q1Of.js";/* empty css                        */import{_ as O}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{c as l,e as f,t as i,n as R,a,F as C,f as S,r as h,i as m,o as U,b as c}from"./runtime-core.esm-bundler.7WHUz9RB.js";const j={__name:"TodaySchedule",setup(N,{expose:r}){r();const v=h(!1),e=h(null),k=h(null),w=h(""),o=h(!1),_=h([]);class y{constructor(t){this.id=t?.id,this.name=t?.name||"",this.teacher=t?.teacher||"",this.price=t?.price||"",this.bookingUrl=t?.bookingUrl||"",this.startTime=t?.date?.start?new Date(t.date.start):new Date,this.endTime=t?.date?.end?new Date(t.date.end):new Date,this.tags=t?.tags||null}get isIceBath(){return this.name?.toLowerCase().includes("dip")||!1}}const E=()=>{v.value=!v.value},B=async()=>{const t=await(await fetch("https://kty-cloudflare-workers.eve-460.workers.dev/kty-schedule-week")).json();e.value=t,_.value=t?.data?.map(n=>new y(n))||[],o.value=!0,console.log("Schedule Items:",_.value.map(n=>({id:n.id,name:n.name,teacher:n.teacher,price:n.price,bookingUrl:n.bookingUrl,startTime:n.startTime,endTime:n.endTime,isIceBath:n.isIceBath,tags:n.tags})))},D=()=>{const s=new Date;return s.setHours(0,0,0,0),s},b=s=>{const t=D(),n=new Date(s);return n.setHours(0,0,0,0),n.getTime()===t.getTime()},u=m(()=>_.value.length?_.value.filter(s=>b(s.startTime)).sort((s,t)=>{const n=s.startTime-t.startTime;return n!==0?n:(s.isIceBath?1:0)-(t.isIceBath?1:0)}):[]),p=m(()=>{if(!u.value.length)return null;const s=new Date;return u.value.filter(t=>t.startTime>s).sort((t,n)=>{const d=t.startTime-n.startTime;return d!==0?d:(t.isIceBath?1:0)-(n.isIceBath?1:0)})[0]||null}),T=m(()=>{if(!u.value.length)return[];const s=new Date;return u.value.filter(t=>s>=t.startTime&&s<=t.endTime)}),L=m(()=>{if(!u.value.length)return[];const s=new Date;return u.value.filter(t=>t.startTime>s).sort((t,n)=>{const d=t.startTime-n.startTime;return d!==0?d:(t.isIceBath?1:0)-(n.isIceBath?1:0)})}),H=m(()=>T.value?.length?T.value.some(s=>s.isIceBath):!1),M=m(()=>T.value?.length?T.value.find(s=>s.isIceBath):null),x=()=>{if(!p.value)return;const s=new Date;w.value=s.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"});const t=p.value.startTime-s,n=Math.floor(t/6e4),d=Math.floor(n/60);k.value=d>0?`${d}h ${n%60}m`:`${n}m`},F=s=>s.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"});U(async()=>{await B(),x(),setInterval(x,6e4)});const I={expanded:v,scheduleResponse:e,timeUntilNext:k,currentTime:w,isLoaded:o,scheduleItems:_,ScheduleItem:y,handleToggleExpand:E,loadSchedule:B,getTodayDate:D,isToday:b,todaysClasses:u,nextClass:p,currentClasses:T,futureClasses:L,nowDipInIceBath:H,currentIceBath:M,updateTimer:x,formatTime:F,ref:h,onMounted:U,computed:m};return Object.defineProperty(I,"__isScriptSetup",{enumerable:!1,value:!0}),I}},P={key:0,class:"schedule-preview"},V={key:1,class:"schedule-list"},z={class:"schedule-header"},A={class:"header-time"},q={key:0,class:"next-class"},G={class:"white"},J={class:"schedule-item highlight"},K={class:"title"},Q={class:"teacher"},W={class:"time"},X={class:"price"},Y=["href"],Z={key:1,class:"current-class"},$={class:"title"},ee={class:"time"},te={class:"upcoming-classes"},se={class:"title"},ne={class:"time"},ae=["href"],ie={class:"full-schedule-container"};function oe(N,r,v,e,k,w){return c(),l(C,null,[e.nowDipInIceBath&&!e.expanded?(c(),l("div",{key:0,class:"ice-bath-live",onClick:e.handleToggleExpand}," ðŸ§Š ICE BATH OPEN UNTIL "+i(e.formatTime(e.currentIceBath?.endTime))+" come now 300THB ",1)):f("",!0),e.scheduleResponse?(c(),l("div",{key:1,class:R(["schedule-widget",{expanded:e.expanded,"fade-in-up":e.isLoaded}]),onClick:e.handleToggleExpand},[!e.expanded&&e.nextClass?(c(),l("div",P,[a("span",null,"Next: "+i(e.nextClass.name),1),a("span",null,"in "+i(e.timeUntilNext),1)])):f("",!0),e.expanded?(c(),l("div",V,[a("div",z,[a("span",A,i(e.currentTime),1),a("button",{class:"close-btn",onClick:g(e.handleToggleExpand,["stop"])},"âœ•")]),e.nextClass?(c(),l("div",q,[a("h3",G,"Next Class in "+i(e.timeUntilNext),1),a("div",J,[a("div",null,[a("div",K,i(e.nextClass.name),1),a("div",Q,"with "+i(e.nextClass.teacher),1),a("div",W,i(e.formatTime(e.nextClass.startTime))+" - "+i(e.formatTime(e.nextClass.endTime)),1),a("div",X,i(e.nextClass.price),1)]),a("a",{href:e.nextClass.bookingUrl,class:"book-btn",target:"_blank",onClick:r[0]||(r[0]=g(()=>{},["stop"]))}," Book Now ",8,Y)])])):f("",!0),e.currentClasses.length?(c(),l("div",Z,[r[3]||(r[3]=a("h3",{class:"white"},"Currently Running:",-1)),(c(!0),l(C,null,S(e.currentClasses,o=>(c(),l("div",{key:o.id,class:"schedule-item in-progress"},[a("div",$,i(o.name),1),a("div",ee,i(e.formatTime(o.startTime))+" - "+i(e.formatTime(o.endTime)),1)]))),128))])):f("",!0),a("div",te,[r[4]||(r[4]=a("h3",{class:"white"},"Upcoming Classes:",-1)),(c(!0),l(C,null,S(e.futureClasses,o=>(c(),l("div",{key:o.id,class:"schedule-item"},[a("div",null,[a("span",se,i(o.name),1),a("span",ne,i(e.formatTime(o.startTime))+" - "+i(e.formatTime(o.endTime))+" - "+i(o.price),1)]),a("a",{href:o.bookingUrl,class:"book-btn",target:"_blank",onClick:r[1]||(r[1]=g(()=>{},["stop"]))}," Book ",8,ae)]))),128))]),a("div",ie,[a("a",{href:"/class-schedule",class:"full-schedule-btn",onClick:r[2]||(r[2]=g(()=>{},["stop"]))}," Check Full Schedule ")])])):f("",!0)],2)):f("",!0)],64)}const ue=O(j,[["render",oe],["__scopeId","data-v-e03f1af3"]]);export{ue as default};
