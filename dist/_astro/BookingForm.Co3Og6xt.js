import{w as F,v as h}from"./runtime-dom.esm-bundler.DOLOcq9E.js";/* empty css                      */import{_ as I}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{c as s,a as t,d as O,e as d,F as T,f as U,t as l,w as C,g as D,n as S,h as v,r as y,i as E,o as N,j as P,b as n}from"./runtime-core.esm-bundler.Dw_mvVhn.js";const V=!1,R={__name:"BookingForm",setup(x,{expose:o}){o();const _="https://flow.thailandboattickets.com/webhook/kty-reserve-mat",e=v({peopleCount:2,name:"",email:"",couponCode:"",isMember:!1}),a=v({i:"",date:"",title:"",teacher:"",time:"",display_date:"",price:"",taxi:""}),c=v({peopleCount:"",name:"",email:"",isMember:""}),r=y(!1),f=y(!1),g=y(""),B=E(()=>a.title||a.teacher||a.display_date||e.name||e.email||e.peopleCount);N(()=>{const i=new URLSearchParams(window.location.search);a.i=i.get("i")||"",a.date=i.get("date")||"",a.title=i.get("title")||"",a.teacher=i.get("teacher")||"",a.time=i.get("time")||"",a.display_date=i.get("display_date")||"",a.price=i.get("price")||"",a.taxi=i.get("taxi")||"";try{const p=localStorage.getItem("booking");if(p){const b=JSON.parse(p);b.person_name&&(e.name=b.person_name),b.person_amount&&(e.peopleCount=b.person_amount),b.contact&&(e.email=b.contact),b.is_member!==void 0&&(e.isMember=b.is_member)}}catch(p){console.error("Error loading booking from cache:",p)}}),P(()=>[e.name,e.email,e.peopleCount],()=>{try{const i={person_name:e.name,person_amount:e.peopleCount,contact:e.email};localStorage.setItem("booking",JSON.stringify(i))}catch(i){console.error("Error saving booking to cache:",i)}});const M=()=>{let i=!0;return c.peopleCount="",c.name="",c.email="",c.isMember="",(!e.peopleCount||e.peopleCount<1)&&(c.peopleCount="Please select number of people",i=!1),e.name.trim()||(c.name="Name is required",i=!1),e.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email)||(c.email="Please enter a valid email",i=!1):(c.email="Email is required",i=!1),(e.isMember===null||e.isMember===void 0)&&(c.isMember="Please select your member status",i=!1),i},w={TEST_MODE:V,BOOKING_API_ENDPOINT:_,formData:e,bookingData:a,errors:c,isSubmitting:r,submitSuccess:f,submitError:g,hasBookingData:B,validateForm:M,resetForm:()=>{e.couponCode="",e.peopleCount=2,e.isMember=!1,f.value=!1,g.value=""},handleSubmit:async()=>{if(M()){r.value=!0,f.value=!1,g.value="";try{let i="";if(a.price&&e.peopleCount){const u=parseFloat(a.price.replace(/[^0-9.-]+/g,""))||0,k=e.peopleCount;i=(u*k).toString()}const p={...e,...a,price:i||a.price,submittedAt:new Date().toISOString()};if(!(await fetch(_,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)})).ok)throw new Error("Failed to submit booking");try{const u=localStorage.getItem("booking"),k=u?JSON.parse(u):{};k.is_member=e.isMember,localStorage.setItem("booking",JSON.stringify(k))}catch(u){console.error("Error saving booking to cache:",u)}const m=new URLSearchParams;m.append("name",e.name),m.append("email",e.email),m.append("peopleCount",e.peopleCount),m.append("isMember",e.isMember),a.i&&m.append("i",a.i),a.title&&m.append("title",a.title),a.teacher&&m.append("teacher",a.teacher),a.time&&m.append("time",a.time),a.display_date&&m.append("display_date",a.display_date),a.price&&m.append("price",a.price),a.date&&m.append("date",a.date),e.couponCode&&m.append("couponCode",e.couponCode),window.location.href=`/after-booking?${m.toString()}`}catch(i){console.error("Error submitting booking:",i),g.value="Failed to submit booking. Please try again.",r.value=!1}}},ref:y,reactive:v,onMounted:N,computed:E,watch:P};return Object.defineProperty(w,"__isScriptSetup",{enumerable:!1,value:!0}),w}},q={class:"booking-container"},J={class:"booking-form-card"},A={key:0,class:"success-state"},Y={class:"form-field"},j={class:"people-selector"},L=["onClick"],W={key:0,class:"form-error"},H={class:"form-field"},z={key:0,class:"form-error"},G={class:"form-field"},K={key:0,class:"form-error"},Q={class:"form-field"},X={class:"form-field"},Z={class:"yes-no-buttons"},$={key:0,class:"form-error"},ee=["disabled"],oe={key:0,class:"button-loader"},te={key:1},ae={key:0,class:"button-hint"},ie={key:1,class:"error-message"},se={class:"booking-info-card"},ne={key:0,class:"booking-details"},re={key:0,class:"booking-detail-item"},le={class:"booking-detail-value"},de={key:1,class:"booking-detail-item"},me={class:"booking-detail-value"},ce={key:2,class:"booking-detail-item"},be={class:"booking-detail-value"},pe={key:3,class:"booking-detail-item"},ue={class:"booking-detail-value"},fe={key:4,class:"booking-detail-item"},ge={class:"booking-detail-value"},ke={key:5,class:"booking-detail-item"},ve={class:"booking-detail-value"},ye={key:6,class:"booking-detail-item"},_e={class:"booking-detail-value"},he={key:7,class:"booking-detail-item"},Ce={class:"booking-detail-value"},De={key:8,class:"booking-detail-item"},Se={class:"booking-detail-value"},Me={class:"booking-detail-item"},we={class:"booking-detail-value"},Ee={key:1,class:"booking-details-empty"};function Ne(x,o,_,e,a,c){return n(),s("div",q,[t("div",J,[e.submitSuccess?(n(),s("div",A,[o[5]||(o[5]=O('<div class="success-icon" data-v-044df84c><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-044df84c><circle cx="12" cy="12" r="10" data-v-044df84c></circle><path d="M9 12l2 2 4-4" data-v-044df84c></path></svg></div><h2 class="success-title" data-v-044df84c>Thank You!</h2><p class="success-message" data-v-044df84c> Your mat has been reserved successfully! We&#39;ll contact you soon with confirmation details. </p>',3)),t("button",{onClick:e.resetForm,class:"reset-button"}," Make Another Booking ")])):(n(),s("form",{key:1,onSubmit:F(e.handleSubmit,["prevent"]),class:"booking-form"},[t("div",Y,[o[6]||(o[6]=t("label",{class:"form-label",for:"people-count"}," How many people ",-1)),t("div",j,[(n(),s(T,null,U(8,r=>t("button",{key:r,type:"button",class:S(["people-button",{"people-button--active":e.formData.peopleCount===r}]),onClick:f=>e.formData.peopleCount=r},l(r),11,L)),64))]),e.errors.peopleCount?(n(),s("div",W,l(e.errors.peopleCount),1)):d("",!0)]),t("div",H,[o[7]||(o[7]=t("label",{class:"form-label",for:"name"},[D(" Your name "),t("span",{class:"form-required"},"*")],-1)),C(t("input",{id:"name","onUpdate:modelValue":o[0]||(o[0]=r=>e.formData.name=r),type:"text",class:"form-input",placeholder:"Enter your name",autocomplete:"name"},null,512),[[h,e.formData.name]]),e.errors.name?(n(),s("div",z,l(e.errors.name),1)):d("",!0)]),t("div",G,[o[8]||(o[8]=t("label",{class:"form-label",for:"email"},[D(" Email "),t("span",{class:"form-required"},"*")],-1)),o[9]||(o[9]=t("p",{class:"form-description"},"We use your email only to inform you about your booking",-1)),C(t("input",{id:"email","onUpdate:modelValue":o[1]||(o[1]=r=>e.formData.email=r),type:"email",class:"form-input",placeholder:"your.email@example.com",autocomplete:"email"},null,512),[[h,e.formData.email]]),e.errors.email?(n(),s("div",K,l(e.errors.email),1)):d("",!0)]),t("div",Q,[o[10]||(o[10]=t("label",{class:"form-label",for:"coupon"}," Coupon Code (optional) ",-1)),o[11]||(o[11]=t("p",{class:"form-description"}," If you have a coupon code you can enter it here. When you pay at the studio you will get your discount. ",-1)),C(t("input",{id:"coupon","onUpdate:modelValue":o[2]||(o[2]=r=>e.formData.couponCode=r),type:"text",class:"form-input",placeholder:"Enter coupon code",autocomplete:"off"},null,512),[[h,e.formData.couponCode]])]),t("div",X,[o[12]||(o[12]=t("label",{class:"form-label"},[D(" Are you already a member? "),t("span",{class:"form-required"},"*")],-1)),t("div",Z,[t("button",{type:"button",class:S(["yn-button",{"yn-button--active":e.formData.isMember===!0}]),onClick:o[3]||(o[3]=r=>e.formData.isMember=!0)}," Yes ",2),t("button",{type:"button",class:S(["yn-button",{"yn-button--active":e.formData.isMember===!1}]),onClick:o[4]||(o[4]=r=>e.formData.isMember=!1)}," No ",2)]),e.errors.isMember?(n(),s("div",$,l(e.errors.isMember),1)):d("",!0)]),t("button",{type:"submit",class:"submit-button",disabled:e.isSubmitting||!e.formData.name.trim()||!e.formData.email.trim()},[e.isSubmitting?(n(),s("span",oe)):(n(),s("span",te,"Reserve mat"))],8,ee),!e.formData.name.trim()||!e.formData.email.trim()?(n(),s("div",ae," Fill your email plus name to reserve your mat ")):d("",!0),e.submitError?(n(),s("div",ie,l(e.submitError),1)):d("",!0)],32))]),t("div",se,[o[25]||(o[25]=t("h2",{class:"booking-info-title"},"Booking Summary",-1)),e.hasBookingData?(n(),s("div",ne,[e.bookingData.title?(n(),s("div",re,[o[13]||(o[13]=t("div",{class:"booking-detail-label"},"Class",-1)),t("div",le,l(decodeURIComponent(e.bookingData.title)),1)])):d("",!0),e.bookingData.teacher?(n(),s("div",de,[o[14]||(o[14]=t("div",{class:"booking-detail-label"},"Teacher",-1)),t("div",me,l(e.bookingData.teacher),1)])):d("",!0),e.bookingData.display_date?(n(),s("div",ce,[o[15]||(o[15]=t("div",{class:"booking-detail-label"},"Date",-1)),t("div",be,l(decodeURIComponent(e.bookingData.display_date)),1)])):d("",!0),e.bookingData.time?(n(),s("div",pe,[o[16]||(o[16]=t("div",{class:"booking-detail-label"},"Time",-1)),t("div",ue,l(decodeURIComponent(e.bookingData.time)),1)])):d("",!0),e.bookingData.price?(n(),s("div",fe,[o[17]||(o[17]=t("div",{class:"booking-detail-label"},"Price",-1)),t("div",ge,l(e.bookingData.price)+" THB",1)])):d("",!0),o[23]||(o[23]=t("div",{class:"booking-detail-divider"},null,-1)),e.formData.peopleCount?(n(),s("div",ke,[o[18]||(o[18]=t("div",{class:"booking-detail-label"},"Number of People",-1)),t("div",ve,l(e.formData.peopleCount),1)])):d("",!0),e.formData.name?(n(),s("div",ye,[o[19]||(o[19]=t("div",{class:"booking-detail-label"},"Name",-1)),t("div",_e,l(e.formData.name),1)])):d("",!0),e.formData.email?(n(),s("div",he,[o[20]||(o[20]=t("div",{class:"booking-detail-label"},"Email",-1)),t("div",Ce,l(e.formData.email),1)])):d("",!0),e.formData.couponCode?(n(),s("div",De,[o[21]||(o[21]=t("div",{class:"booking-detail-label"},"Coupon Code",-1)),t("div",Se,l(e.formData.couponCode),1)])):d("",!0),t("div",Me,[o[22]||(o[22]=t("div",{class:"booking-detail-label"},"Member Status",-1)),t("div",we,l(e.formData.isMember?"Member":"Not a member"),1)])])):(n(),s("div",Ee,o[24]||(o[24]=[t("p",null,"Fill in the form to see your booking details",-1)])))])])}const Te=I(R,[["render",Ne],["__scopeId","data-v-044df84c"]]);export{Te as default};
